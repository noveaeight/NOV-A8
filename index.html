<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>3D Shopify Style Store</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    html,body{margin:0;overflow:hidden;background:#0f0f0f;font-family:Arial}
    #ui{
      position:fixed;bottom:20px;left:50%;transform:translateX(-50%);
      background:#000c;color:#fff;padding:12px 20px;border-radius:999px;
      display:flex;gap:12px;align-items:center
    }
    #buy{background:#fff;color:#000;border:none;padding:8px 16px;border-radius:20px;cursor:pointer}
    #hint{position:fixed;top:20px;left:50%;transform:translateX(-50%);color:#aaa;font-size:14px}
  </style>
</head>
<body>

<div id="hint">WASD 이동 · 마우스로 시점 · 상품 클릭</div>
<div id="ui">
  <span>SHOPIFY · 3D STORE</span>
  <button id="buy">BUY</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>
<script>
/* ================= 기본 세팅 ================= */
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x0f0f0f);

const camera = new THREE.PerspectiveCamera(70, innerWidth/innerHeight, 0.1, 1000);
camera.position.set(0, 1.6, 6);

const renderer = new THREE.WebGLRenderer({ antialias:true });
renderer.setSize(innerWidth, innerHeight);
document.body.appendChild(renderer.domElement);

/* ================= 조명 ================= */
scene.add(new THREE.AmbientLight(0xffffff, 0.5));
const spot = new THREE.SpotLight(0xffffff, 1.2);
spot.position.set(2,6,3);
scene.add(spot);

/* ================= 공간 ================= */
const floor = new THREE.Mesh(
  new THREE.PlaneGeometry(50,50),
  new THREE.MeshStandardMaterial({ color:0x1a1a1a })
);
floor.rotation.x = -Math.PI/2;
scene.add(floor);

const backWall = new THREE.Mesh(
  new THREE.PlaneGeometry(50,10),
  new THREE.MeshStandardMaterial({ color:0x121212 })
);
backWall.position.set(0,5,-10);
scene.add(backWall);

/* ================= 상품 ================= */
const product = new THREE.Mesh(
  new THREE.BoxGeometry(1,1.6,0.4),
  new THREE.MeshStandardMaterial({ color:0xffffff, roughness:0.2, metalness:0.1 })
);
product.position.set(0,1.6,-2);
scene.add(product);

/* ================= FPS 이동 ================= */
const keys = {};
addEventListener('keydown',e=>keys[e.key.toLowerCase()]=true);
addEventListener('keyup',e=>keys[e.key.toLowerCase()]=false);

let yaw = 0, pitch = 0;
addEventListener('mousemove',e=>{
  yaw -= e.movementX * 0.002;
  pitch -= e.movementY * 0.002;
  pitch = Math.max(-1.2, Math.min(1.2, pitch));
});

function moveCamera(){
  camera.rotation.set(pitch, yaw, 0);
  const dir = new THREE.Vector3();
  camera.getWorldDirection(dir);
  dir.y = 0;
  dir.normalize();

  const right = new THREE.Vector3().crossVectors(camera.up, dir).normalize();

  if(keys['w']) camera.position.addScaledVector(dir, 0.08);
  if(keys['s']) camera.position.addScaledVector(dir, -0.08);
  if(keys['a']) camera.position.addScaledVector(right, 0.08);
  if(keys['d']) camera.position.addScaledVector(right, -0.08);
}

/* ================= 클릭 감지 ================= */
const raycaster = new THREE.Raycaster();
const mouse = new THREE.Vector2();
addEventListener('click',e=>{
  mouse.x = (e.clientX/innerWidth)*2-1;
  mouse.y = -(e.clientY/innerHeight)*2+1;
  raycaster.setFromCamera(mouse, camera);
  const hit = raycaster.intersectObject(product);
  if(hit.length) alert('상품 상세 → Shopify 결제 연결 위치');
});

/* ================= BUY 버튼 ================= */
document.getElementById('buy').onclick = ()=>{
  alert('여기에 Shopify Buy Button URL 연결');
};

/* ================= 반응형 ================= */
addEventListener('resize',()=>{
  camera.aspect = innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth,innerHeight);
});

/* ================= 루프 ================= */
(function animate(){
  requestAnimationFrame(animate);
  product.rotation.y += 0.01;
  moveCamera();
  renderer.render(scene,camera);
})();
</script>
</body>
</html>
